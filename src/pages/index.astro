---
import Layout from '../layouts/Layout.astro';
import Header from '../components/header.astro';
import Seccion from "../components/Seccion.astro";
import Categorias from '../components/Categorias.astro';
import Forsale from '../components/ForSale.astro';
import Footer from '../components/footer.astro';
import New from '../components/New.astro';
import Productos from '../components/Productos.astro';
import '../styles/global.css';

const response = await fetch('http://localhost:3000/api/productos');

if (!response.ok) {
  console.error('Error al obtener productos:', response.statusText);
  const errorText = await response.text(); // Captura el texto del error
  throw new Error(`Error al obtener productos: ${errorText}`);
}

const products = await response.json(); // Intenta parsear solo si todo está bien
---

<Layout title="MYU WEB">
        <style>
            body {
                margin: 0;
                background-color: #fffcf6;
            }

            /* Agregamos padding al body en pantallas móviles */
            @media (max-width: 768px) {
                main {
                    padding-left: 10px;
                    padding-right: 10px;
                }
            }
        </style>
        <Header />
        <br>
        <br>    
        <Seccion />
        <main>
        <Categorias />
        <Forsale />
        <New />
        <Productos products={products} />      
        </main>
        <Footer />
</Layout>
